upstream passengerOrderAppFront {
        server 172.18.5.29:18980;
}

upstream passengerGpsAppFront {
        server 172.18.5.29:18940;
}


upstream passengerAppFront {
        server 172.18.5.29:18960;
}

upstream passengerAppGateway {
        server 172.18.5.29:8600;
}

server {
        listen       8600;
        server_name  passengerGateway-dev1.wsecar.com;
        access_log   logs/passengerGateway-dev1.wsecar.com.log  main;
        location ~ ^/(passenger|app|user|im|mapService|chargingService|message|recommend|trafficTrip|safeCenter|activity) {
                proxy_redirect  off;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Host $http_host;
                client_max_body_size 30M;
                proxy_http_version 1.1;
                proxy_set_header Connection "";
                proxy_pass http://passengerAppFront;
        }

        location /carOrder {
                proxy_redirect  off;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Host $http_host;
                client_max_body_size 30M;
                proxy_http_version 1.1;
                proxy_set_header Connection "";
                proxy_pass http://passengerOrderAppFront;
        }

        location =/mapService/passenger/uploadGps {
                proxy_redirect  off;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Host $http_host;
                client_max_body_size 30M;
                proxy_http_version 1.1;
                proxy_set_header Connection "";
                proxy_pass http://passengerGpsAppFront;
        }

        location  ~ ^/(carLife|driving) {
                proxy_redirect  off;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Host $http_host;
                client_max_body_size 30M;
                proxy_http_version 1.1;
                proxy_set_header Connection "";
                proxy_pass http://passengerAppGateway;
        }

}


server {
        listen       8601 ssl ;
        server_name  passengerGateway-dev1.wsecar.com;
        access_log   logs/passengerGateway-dev1.wsecar.com.log  main;
        ssl_certificate  ssl/wsecar.com.pem;
        ssl_certificate_key   ssl/wsecar.com.key;
        ssl_session_timeout 5m;
        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;
        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
        ssl_prefer_server_ciphers on;


        location ~ ^/(passenger|app|user|im|mapService|chargingService|message|recommend|trafficTrip|safeCenter|activity) {
                proxy_redirect  off;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Host $http_host;
                client_max_body_size 30M;
                proxy_http_version 1.1;
                proxy_set_header Connection "";
                proxy_pass http://passengerAppFront;
        }

        location /carOrder {
                proxy_redirect  off;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Host $http_host;
                client_max_body_size 30M;
                proxy_http_version 1.1;
                proxy_set_header Connection "";
                proxy_pass http://passengerOrderAppFront;
        }

        location =/mapService/passenger/uploadGps {
                proxy_redirect  off;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Host $http_host;
                client_max_body_size 30M;
                proxy_http_version 1.1;
                proxy_set_header Connection "";
                proxy_pass http://passengerGpsAppFront;
        }

        location  ~ ^/(carLife|driving) {
                proxy_redirect  off;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Host $http_host;
                client_max_body_size 30M;
                proxy_http_version 1.1;
                proxy_set_header Connection "";
                proxy_pass http://passengerAppGateway;
        }

}
