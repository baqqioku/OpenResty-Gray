upstream driverAppFront {
        server 172.19.80.27:18950;
                server 172.19.80.30:18950;
}

upstream gpsAppFront {
        server 172.19.80.21:18940;
                server 172.19.80.22:18940;
                server 172.19.80.23:18940;
                server 172.19.80.24:18940;
                server 172.19.80.25:18947;
                server 172.19.80.26:18947;
}

upstream driverOrderAppFront {
        server 172.19.80.33:18970;
                server 172.19.80.249:18970;
}

upstream driverGateWay {
        server 172.19.80.28:8500;
                server 172.19.80.29:8500;
}

server {
        listen       8500 ;
        server_name  driverGateway-opnet.wsecar.com;
        access_log   logs/driverGateway.wsecar.com.log  main;

        location = /healthCheck {
                    #设置content type
                    default_type text/html ;
                    # HTTP Status Code 和 内容 
                    return 200  "hello world! ";
        }

        location ~ ^/(driver|finance|message|recommend|trafficTrip|driverCenter|app|im|mapService|safeCenter|carSupplier) {
                        proxy_redirect  off;
                        proxy_set_header X-Real-IP $remote_addr;
                        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                        proxy_set_header Host $http_host;
                        client_max_body_size 30M;
                        proxy_http_version 1.1;
                        proxy_set_header Connection "";
                        proxy_pass http://driverAppFront;
        }

        #location =/mapService/exp/uploadGps {
        #                proxy_redirect  off;
        #                proxy_set_header X-Real-IP $remote_addr;
        #                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        #                proxy_set_header Host $http_host;
        #                client_max_body_size 30M;
        #                proxy_http_version 1.1;
        #                proxy_set_header Connection "";
        #                proxy_pass http://gpsAppFront;
        #}

        location =/mapService/exp/uploadGps {
                    #设置content type
                    default_type text/html ;
                    # HTTP Status Code 和 内容 
                    return 200  "hello world! ";
        }

        location =/mapService/taxi/uploadGps {
                        proxy_redirect  off;
                        proxy_set_header X-Real-IP $remote_addr;
                        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                        proxy_set_header Host $http_host;
                        client_max_body_size 30M;
                        proxy_http_version 1.1;
                        proxy_set_header Connection "";
                        proxy_pass http://gpsAppFront;
        }

        location /carOrder {
                        proxy_redirect  off;
                        proxy_set_header X-Real-IP $remote_addr;
                        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                        proxy_set_header Host $http_host;
                        client_max_body_size 30M;
                        proxy_http_version 1.1;
                        proxy_set_header Connection "";
                        proxy_pass http://driverOrderAppFront;
        }        

        location  ~ ^/(carLife|driving) {
                        proxy_redirect  off;
                        proxy_set_header X-Real-IP $remote_addr;
                        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                        proxy_set_header Host $http_host;
                        client_max_body_size 30M;
                        proxy_http_version 1.1;
                        proxy_set_header Connection "";
                        proxy_pass http://driverGateWay;
        }        
    }


server {
        listen       8501 ssl;
        server_name  driverGateway-opnet.wsecar.com;
        access_log   logs/driverGateway.wsecar.com.log  main;

        ssl_certificate  ssl/wsecar.com.pem;
        ssl_certificate_key   ssl/wsecar.com.key;
        ssl_session_timeout 5m;
        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;
        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
        ssl_prefer_server_ciphers on;

        location ~ ^/(driver|finance|message|recommend|trafficTrip|driverCenter|app|im|mapService|safeCenter|carSupplier) {
                        proxy_redirect  off;
                        proxy_set_header X-Real-IP $remote_addr;
                        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                        proxy_set_header Host $http_host;
                        client_max_body_size 30M;
                        proxy_http_version 1.1;
                        proxy_set_header Connection "";
                        proxy_pass http://driverAppFront;
        }


        location =/mapService/exp/uploadGps {
                    #设置content type
                    default_type text/html ;
                    # HTTP Status Code 和 内容
                    return 200  "hello driver! ";
        }


        location =/mapService/taxi/uploadGps {
                        proxy_redirect  off;
                        proxy_set_header X-Real-IP $remote_addr;
                        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                        proxy_set_header Host $http_host;
                        client_max_body_size 30M;
                        proxy_http_version 1.1;
                        proxy_set_header Connection "";
                        proxy_pass http://gpsAppFront;
        }

        location /carOrder {
                        proxy_redirect  off;
                        proxy_set_header X-Real-IP $remote_addr;
                        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                        proxy_set_header Host $http_host;
                        client_max_body_size 30M;
                        proxy_http_version 1.1;
                        proxy_set_header Connection "";
                        proxy_pass http://driverOrderAppFront;
        }        

        location  ~ ^/(carLife|driving) {
                        proxy_redirect  off;
                        proxy_set_header X-Real-IP $remote_addr;
                        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                        proxy_set_header Host $http_host;
                        client_max_body_size 30M;
                        proxy_http_version 1.1;
                        proxy_set_header Connection "";
                        proxy_pass http://driverGateWay;
        }        
    }
